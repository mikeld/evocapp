(function(){'use strict';var d,c,b,e,f,g;function a(b,d){var h,f,g,e,j;if(d=d||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=d.touchBoundary||10,this.layer=b,this.tapDelay=d.tapDelay||200,this.tapTimeout=d.tapTimeout||700,a.notNeeded(b))return;function i(a,b){return function(){return a.apply(b,arguments)}}f=['onMouse','onClick','onTouchStart','onTouchMove','onTouchEnd','onTouchCancel'],g=this;for(e=0,j=f.length;e<j;e++)g[f[e]]=i(g[f[e]],g);c&&(b.addEventListener('mouseover',this.onMouse,!0),b.addEventListener('mousedown',this.onMouse,!0),b.addEventListener('mouseup',this.onMouse,!0)),b.addEventListener('click',this.onClick,!0),b.addEventListener('touchstart',this.onTouchStart,!1),b.addEventListener('touchmove',this.onTouchMove,!1),b.addEventListener('touchend',this.onTouchEnd,!1),b.addEventListener('touchcancel',this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(b.removeEventListener=function(a,c,d){var e=Node.prototype.removeEventListener;a==='click'?e.call(b,a,c.hijacked||c,d):e.call(b,a,c,d)},b.addEventListener=function(c,a,d){var e=Node.prototype.addEventListener;c==='click'?e.call(b,c,a.hijacked||(a.hijacked=function(b){b.propagationStopped||a(b)}),d):e.call(b,c,a,d)}),typeof b.onclick=='function'&&(h=b.onclick,b.addEventListener('click',function(a){h(a)},!1),b.onclick=null)}d=navigator.userAgent.indexOf("Windows Phone")>=0,c=navigator.userAgent.indexOf('Android')>0&&!d,b=/iP(ad|hone|od)/.test(navigator.userAgent)&&!d,e=b&&/OS 4_\d(_\d)?/.test(navigator.userAgent),f=b&&/OS [6-7]_\d/.test(navigator.userAgent),g=navigator.userAgent.indexOf('BB10')>0,a.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case'button':case'select':case'textarea':if(a.disabled)return!0;break;case'input':if(b&&a.type==='file'||a.disabled)return!0;break;case'label':case'iframe':case'video':return!0}return/\bneedsclick\b/.test(a.className)},a.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case'textarea':return!0;case'select':return!c;case'input':switch(a.type){case'button':case'checkbox':case'file':case'image':case'radio':case'submit':return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},a.prototype.sendClick=function(c,d){var b,a;document.activeElement&&document.activeElement!==c&&document.activeElement.blur(),a=d.changedTouches[0],b=document.createEvent('MouseEvents'),b.initMouseEvent(this.determineEventType(c),!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),b.forwardedTouchEvent=!0,c.dispatchEvent(b)},a.prototype.determineEventType=function(a){return c&&a.tagName.toLowerCase()==='select'?'mousedown':'click'},a.prototype.focus=function(a){var c;b&&a.setSelectionRange&&a.type.indexOf('date')!==0&&a.type!=='time'&&a.type!=='month'&&a.type!=='email'?(c=a.value.length,a.setSelectionRange(c,c)):a.focus()},a.prototype.updateScrollParent=function(c){var b,a;if(b=c.fastClickScrollParent,!b||!b.contains(c)){a=c;do{if(a.scrollHeight>a.offsetHeight){b=a,c.fastClickScrollParent=a;break}a=a.parentElement}while(a)}b&&(b.fastClickLastScrollTop=b.scrollTop)},a.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a},a.prototype.onTouchStart=function(a){var d,c,f;if(a.targetTouches.length>1)return!0;if(d=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],b){if(f=window.getSelection(),f.rangeCount&&!f.isCollapsed)return!0;if(!e){if(c.identifier&&c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(d)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=d,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},a.prototype.touchHasMoved=function(c){var a=c.changedTouches[0],b=this.touchBoundary;return!!(Math.abs(a.pageX-this.touchStartX)>b||Math.abs(a.pageY-this.touchStartY)>b)},a.prototype.onTouchMove=function(a){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0)},a.prototype.findControl=function(a){return a.control!==void 0?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea')},a.prototype.onTouchEnd=function(d){var i,k,g,h,j,a=this.targetElement;if(!this.trackingClick)return!0;if(d.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(d.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=d.timeStamp,k=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,f&&(j=d.changedTouches[0],a=document.elementFromPoint(j.pageX-window.pageXOffset,j.pageY-window.pageYOffset)||a,a.fastClickScrollParent=this.targetElement.fastClickScrollParent),g=a.tagName.toLowerCase(),g==='label'){if(i=this.findControl(a),i){if(this.focus(a),c)return!1;a=i}}else if(this.needsFocus(a))return d.timeStamp-k>100||b&&window.top!==window&&g==='input'?(this.targetElement=null,!1):(this.focus(a),this.sendClick(a,d),(!b||g!=='select')&&(this.targetElement=null,d.preventDefault()),!1);if(b&&!e)if(h=a.fastClickScrollParent,h&&h.fastClickLastScrollTop!==h.scrollTop)return!0;return this.needsClick(a)||(d.preventDefault(),this.sendClick(a,d)),!1},a.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},a.prototype.onMouse=function(a){return!this.targetElement||(!!a.forwardedTouchEvent||(!a.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1))))},a.prototype.onClick=function(a){var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):!!(a.target.type==='submit'&&a.detail===0)||(b=this.onMouse(a),b||(this.targetElement=null),b)},a.prototype.destroy=function(){var a=this.layer;c&&(a.removeEventListener('mouseover',this.onMouse,!0),a.removeEventListener('mousedown',this.onMouse,!0),a.removeEventListener('mouseup',this.onMouse,!0)),a.removeEventListener('click',this.onClick,!0),a.removeEventListener('touchstart',this.onTouchStart,!1),a.removeEventListener('touchmove',this.onTouchMove,!1),a.removeEventListener('touchend',this.onTouchEnd,!1),a.removeEventListener('touchcancel',this.onTouchCancel,!1)},a.notNeeded=function(b){var a,d,e,f;if(typeof window.ontouchstart=='undefined')return!0;if(d=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],d)if(c){if(a=document.querySelector('meta[name=viewport]'),a){if(a.content.indexOf('user-scalable=no')!==-1)return!0;if(d>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}else return!0;if(g)if(e=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),e[1]>=10&&e[2]>=3)if(a=document.querySelector('meta[name=viewport]'),a){if(a.content.indexOf('user-scalable=no')!==-1)return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}if(b.style.msTouchAction==='none'||b.style.touchAction==='manipulation')return!0;if(f=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],f>=27)if(a=document.querySelector('meta[name=viewport]'),a&&(a.content.indexOf('user-scalable=no')!==-1||document.documentElement.scrollWidth<=window.outerWidth))return!0;return!!(b.style.touchAction==='none'||b.style.touchAction==='manipulation')},a.attach=function(b,c){return new a(b,c)},typeof define=='function'&&typeof define.amd=='object'&&define.amd?define(function(){return a}):typeof module!='undefined'&&module.exports?(module.exports=a.attach,module.exports.FastClick=a):window.FastClick=a})()